# Request-CVE-ID
In WP Visitor Statistics 6.9.3, due to simple filtering of user data, secondary encoding injection can be performed and directly spliced into sql statements, resulting in sql injection vulnerability.

Impact Version
Osamaesh WP Visitor Statistics<=6.9.3
Project Address: https://wordpress.org/plugins/wp-stats-manager/
vulnerability recurrence
http://localhost/?wmcAction=wmcTrack&visitorId=121212%27+and+sleep(10)+or+%27
image
vulnerability analysis
The entry function of the plug-in is as follows

image In the initWsm initialization function, the following actions are registered. The meaning is that the wsm_plugin_init function is called when the web site is visited image The wsm_plugin_init is as follows. When visiting a URL like http://xxxx/? Enter wsmRequests if wmcAction=wmcTrack image In the constructor of wsmRequests, due to the simple filtering of user data, you can perform secondary encoding injection to adjust fnHandleVisit image The parameters accessed for the first time are processed in fnHandleNewVisit image In fnInsertNewVisit, the passed-in visitorId is spliced and the sql statement is executed image repair mode The vendor has not released a solution yet Safety researcher Mr. Li personally suggested: Use parameterized queries or prepared statements: Rather than just using escape processing, a better approach is to use parameterized queries or prepared statements to build SQL queries. Parameterized queries are executed by separating the query statement from the parameters, thus separating the input data from the query logic and effectively preventing SQL injection attacks.
